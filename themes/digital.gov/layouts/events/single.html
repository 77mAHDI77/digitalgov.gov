{{ define "content" }}
{{/* This sets $future_event to true or false */}}
{{ $future_event := (time .Params.end_date).After now }}

<main role="main">
  <article>
    <div class="grid-container">

      <div class="grid-row">
        <div class="grid-col-12">
          <header>
            <a class="breadcrumb" href="{{ "events/" | absURL }}"> &laquo; All Events </a>
            <h1>{{ .Title | markdownify }}</h1>
            {{/* Deck */}}
            {{- if .Params.deck -}}
            <div class="deck">{{- .Params.deck -}}</div>
            {{- end -}}
          </header>
        </div>
      </div>

      <div class="grid-row">
        <div class="grid-col-12">
          {{/* Register */}}
          <a class="btn event_register" href="{{ .Params.registration_url }}" onclick="__gaTracker('send', 'event', 'outbound-article', '{{ .Params.registration_url }}', 'REGISTER NOW');">Register</a>

          {{/* Add to Calendar */}}
          {{ $event_startDate := dateFormat "2006-01-02 03:04 PM" (time .Params.date) }}
          {{ $event_endDate := dateFormat "2006-01-02 03:04 PM" (time .Params.end_date) }}
          {{ $event_url := (print "\n\nEvent Page: https:" .Permalink) }}
          {{ $.Scratch.Set "event_youtube" "" }}
          {{ if (isset .Params "youtube_id") }}
            {{ $.Scratch.Set "event_youtube" (print "\nYouTube LIVE: https://www.youtube.com/watch?v=" .Params.youtube_id) }}
          {{ end }}
          {{ $event_youtube := $.Scratch.Get "event_youtube" }}
          {{ $event_title := .Title | markdownify }}
          {{ $event_desc := $.Params.summary | default $.Site.Params.description | markdownify }}
          {{ $event_description := (print $event_desc $event_url $event_youtube) }}
          {{ $event_location := .Params.venue.venue_name }}

          <span class="addtocalendar btn">
            <var class="atc_event">
              <var class="atc_date_start">{{ $event_startDate }}</var>
              <var class="atc_date_end">{{ $event_endDate }}</var>
              <var class="atc_timezone">America/New_York</var>
              <var class="atc_title">{{ $event_title }}</var>
              <var class="atc_description">{{ htmlUnescape $event_description | safeHTML }}</var>
              <var class="atc_location">{{ $event_location }}</var>
              <var class="atc_organizer">DigitalGov</var>
              <var class="atc_organizer_email">digitalgov@gsa.gov</var>
            </var>
          </span>
          <script type="text/javascript">(function () {
            if (window.addtocalendar)if(typeof window.addtocalendar.start == "function")return;
            if (window.ifaddtocalendar == undefined) { window.ifaddtocalendar = 1;
                var d = document, s = d.createElement('script'), g = 'getElementsByTagName';
                s.type = 'text/javascript';s.charset = 'UTF-8';s.async = true;
                s.src = ('https:' == window.location.protocol ? 'https' : 'http')+'://addtocalendar.com/atc/1.5/atc.min.js';
                var h = d[g]('body')[0];h.appendChild(s); }})();
          </script>
        </div>
      </div>

      {{ if (isset .Params "youtube_id") }}

        {{/* If is a Future Event */}}
        {{ if eq $future_event true }}
        <section class="stage">
          <div class="grid-row grid-gap-2">
            <div class="grid-col-12 tablet:grid-col-9">
              <div class="video-box">
                <div class="youtube-player">
                  <iframe src="https://www.youtube.com/embed/{{ .Params.youtube_id }}?autoplay=1" frameborder="0" allowfullscreen="1"></iframe>
                </div>
              </div>
            </div>
            <div class="grid-col-12 tablet:grid-col-3">
              <div class="chat-box">
                <iframe allowfullscreen="" height="400px" frameborder="0" src="https://www.youtube.com/live_chat?v={{ .Params.youtube_id }}&embed_domain=digital.gov&output=embed" scrolling="auto"></iframe>
              </div>
            </div>
          </div>
          <div class="grid-row grid-gap-2">
            <div class="grid-col-12 tablet:grid-col-9">
              <div class="event-tools">
                <a href="https://www.youtube.com/watch?v={{ .Params.youtube_id }}" title="Watch on YouTube"><strong>Watch on YouTube</strong></a>
              </div>
            </div>
            <div class="grid-col-12 tablet:grid-col-3">
            </div>
          </div>
        </section>

        {{ end }}

        {{/* If is NOT a Future Event (Past event) */}}
        {{ if eq $future_event false }}
        <section class="stage">
          <div class="grid-row">
            <div class="grid-col-12">
              <section class="video-box">
                <div class="youtube-player">
                  <iframe src="https://www.youtube.com/embed/{{ .Params.youtube_id }}?autoplay=1" frameborder="0" allowfullscreen="1"></iframe>
                </div>
              </section>
            </div>
          </div>
        </section>
        {{ end }}



      {{ end }}

      <div class="grid-row">
        <div class="grid-col-12 tablet:grid-col-9">
          <div class="content">
            {{ .Content }}
          </div>
        </div>
      </div>



          {{/* If is a Future Event */}}
          {{ if eq $future_event true }}


          {{ end }}

          {{/* If is NOT a Future Event (Past event) */}}
          {{ if eq $future_event false }}


          {{ end }}


        </div>
      </div>
    </div>
  </article>
</main>

{{ end }}
