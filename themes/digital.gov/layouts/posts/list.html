{{ define "content" }}

<main role="main">
  <header>
    <div class="grid-container grid-container-desktop">
      <div class="grid-row grid-gap-4">
        <div class="grid-col-12">
          <h1>Spotlight</h1>
          <p>A round-up of recent news and resources from across our community</p>
        </div>
      </div>
    </div>
  </header>

  <section class="article-list">
    <div class="grid-container grid-container-desktop">
      <div class="grid-row grid-gap-4">
        <div class="grid-col-12 display-none tablet:display-block tablet:grid-col-4 tablet-lg:grid-col-3">
          {{ partial "core/top-topics.html" . }}
        </div>
        <div class="grid-col-12 tablet:grid-col-8 tablet-lg:grid-col-9">
          {{/* Blog Posts by Topic —
          List all of the blog posts tagged with this topic */}}
          {{ $pages := .Paginate (where .Site.RegularPages.ByDate.Reverse "Section" "posts") }}

          {{/* If there are any resources at all... */}}
          {{ if $pages }}

            {{/* Loop through all the pages */}}
            {{ range $pages.Pages }}

              {{/* If the source is identified in the article */}}
              {{- if .Params.source -}}
                {{- $source := $.Site.GetPage "page" (print "source_" .Params.source ) -}}
              {{- end -}}

              {{/* If the type is a SPOT (means it links to another publication) */}}
              {{ if eq .Params.type "spot" }}

                <article data-edit-this="{{- .File.Path -}}">
                  <p>
                    {{/* Favicon
                    If the there is a custom favicon set in /sources/source_[slug].md, then use that... */}}
                    {{- if .Params.source -}}

                      {{- $source := $.Site.GetPage "page" (print "source_" .Params.source ) -}}
                      {{- if $source.Params.icon -}}
                        <img src="{{ $source.Params.icon }}" alt="">
                      {{- else -}}
                        <img src="https://www.google.com/s2/favicons?domain={{- .Params.source_url -}}" alt="">
                      {{- end -}}

                    {{/* Otherwise, use the Favicon that Google stores for the site. */}}
                    {{- else -}}
                      <img src="https://www.google.com/s2/favicons?domain={{- .Params.source_url -}}" alt="">
                    {{- end -}}

                    {{- .Params.deck | markdownify }} <em>(via&nbsp;<a href="{{- .Params.source_url -}}">{{ .Params.source_name }}</a>)</em> <i class="fas fa-external-link-alt"></i></p>

                  <a href="{{- .Params.source_url -}}" title="{{- .Params.source_name -}}"><span></span></a>
                </article>

              {{/* If the type is a digital.gov Blog Post */}}
              {{ else }}

                <article data-edit-this="{{- .File.Path -}}">
                  <p><img src="{{ "img/digit-16.png" | absURL }}" alt=""><a href="{{- .Permalink -}}"><strong>{{- .Title | markdownify -}}</strong></a>{{- if .Params.deck }} — {{ .Params.deck -}}{{- end -}}&nbsp;<em class="date">({{ .Date.Format "Jan _2, 2006" -}})</em></p>
                  <a href="{{- .Permalink -}}" title="{{- .Title | markdownify -}}"><span></span></a>
                </article>
              {{ end }}


            {{ end }}
          {{ end }}
          {{ partial "core/pagination.html" . }}
        </div>
      </div>
    </div>
  </section>
</main>
{{ end }}
