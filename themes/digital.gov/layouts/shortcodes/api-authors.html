{{- partial "core/set-env.html" . -}}
{{- $list := (where .Site.Pages "Section" "authors") -}}
{{- $length := len $list -}}
{
  "version" : "https://jsonfeed.org/version/1",
  "content" : "authors",
  "type" : "list",
  "title" : "Authors | {{ .Site.Title }}",
  "home_page_url" : "{{- .Site.BaseURL -}}",
  "count" : "{{- $length }}",
  {{ with .Site.Author.name -}}
  "author" : {
      "name" : "{{- . -}}"{{- with $.Site.Author.url -}},
      "url": "{{- . -}}"{{- end -}}{{- with $.Site.Author.avatar -}},
      "avatar": "{{- . | absURL -}}"{{- end -}}
  },
  {{- end -}}
  "items" : [{
  {{ range $index, $author := $list -}}
    "{{- $author.Params.uid -}}" : {
      "uid" : "{{- $author.Params.uid -}}",
      "display_name" : "{{- $author.Params.display_name -}}",
      "first_name" : "{{- $author.Params.first_name -}}",
      "last_name" : "{{- $author.Params.last_name -}}",
      "pronoun" : "{{- $author.Params.pronoun -}}",
      "email" : "{{- $author.Params.email -}}",
      "location" : "{{- $author.Params.location -}}",
      "bio" : "{{- $author.Params.bio -}}",
      "bio_url" : "{{- $author.Params.bio_url -}}",
      "agency" : "{{- $author.Params.agency -}}",
      "agency_full_name" : "{{- $author.Params.agency_full_name -}}",
      "github" : "{{- $author.Params.github -}}",
      "profile_source" : "{{- $author.Params.profile_source -}}",
      "twitter" : "{{- $author.Params.twitter -}}",
      "facebook" : "{{- $author.Params.facebook -}}",
      "linkedin" : "{{- $author.Params.linkedin -}}",
      "youtube" : "{{- $author.Params.youtube -}}",
      "branch" : {{ $.Scratch.Get "branch" | jsonify }},
      "filename" : {{ .File.LogicalName | jsonify }},
      "filepath" : {{ .File.Path | jsonify }},
      "filepathURL" : {{ printf "https://github.com/%s/%s/blob/%s/content/%s" $.Site.Params.git_org $.Site.Params.git_repo ($.Scratch.Get "branch") .File.Path | jsonify }},
      "editpathURL" : {{ printf "https://github.com/%s/%s/edit/%s/content/%s" $.Site.Params.git_org $.Site.Params.git_repo ($.Scratch.Get "branch") .File.Path | jsonify }},
      "url" : "{{- .Permalink -}}"
    }{{- $.Scratch.Add "i" 1 -}}
    {{- $iterator := $.Scratch.Get "i" -}}
    {{- if not (eq $length $iterator) -}}, {{- end -}}
  {{ end }}
  }]
}
